<%- include('../partials/header') %>

  <section class="container my-5">
    <h2 class="mb-4 text-center">My Reservations</h2>

    <% if (reservations.length> 0) { %>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>#</th>
            <th>Restaurant</th>
            <th>Date</th>
            <th>Time</th>
            <th>Guests</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% reservations.forEach((r, i)=> { %>
            <tr>
              <td>
                <%= i + 1 %>
              </td>
              <td>
                <%= r.restaurant ? r.restaurant.name : 'â€”' %>
              </td>
              <td>
                <%= new Date(r.date).toLocaleDateString() %>
              </td>
              <td>
                <%= r.time %>
              </td>
              <td>
                <%= r.guests %>
              </td>
              <td>
                <span
                  class="badge <%= r.status==='pending'?'bg-warning text-dark': r.status==='confirmed'?'bg-info': r.status==='completed'?'bg-success':'bg-danger' %>">
                  <%= r.status %>
                </span>
              </td>
              <td>
                <% if(r.status !=='cancelled' ) { %>
                  <form action="/reserve/update/<%= r._id %>" method="POST">
                    <select name="status" class="form-select form-select-sm mb-1" style="width:120px;">
                      <option value="pending" <%=r.status==='pending' ?'selected':'' %>>Pending</option>
                      <option value="confirmed" <%=r.status==='confirmed' ?'selected':'' %>>Confirmed</option>
                      <option value="cancelled" <%=r.status==='cancelled' ?'selected':'' %>>Cancel</option>
                    </select>

                    <button type="submit" class="btn btn-sm btn-primary w-100">Update</button>
                  </form>
                  <% } else { %>
                    <span class="text-muted">No action</span>
                    <% } %>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>
      <% } else { %>
        <p class="text-center text-muted">You have no reservations yet.</p>
        <% } %>
  </section>

  <%- include('../partials/footer') %>